.. _service-mail:

Email
#####
Self-hosted email services (:term:`MDA`, :term:`MTA`). Setup focuses on running
a secure mail server with the latest security options.

.. toctree::
   :hidden:
   :maxdepth: -1

   manual-testing

.. role:: mail
  :galaxy:       https://galaxy.ansible.com/r_pufky/mail
  :source:       https://github.com/r-pufky/ansible_mail
  :service_doc:  https://github.com/r-pufky/ansible_mail
  :ref:          http://www.postfix.org/,
                 https://hub.docker.com/r/tvial/docker-mailserver/
  :update:       2022-10-09
  :open:

  Role handles all steps that are provided in this documentation.

  * **Highly Recommended** to set ``mail_confirmation_prompt`` to **true**
    enabling interactive setup with user prompts for first time run. This will
    walk you through all required steps to configure the mail server.
    Subsequent runs can disable this to automatically apply the role.
  * Mail service should be placed on an isolated network as it is exposed to
    the world.
  * POP3 and non TLS/SSL connections should be considered compromised by
    default. If enabling remote :term:`MUA` connections, Use **TLS/SSL IMAP**.
    Port ``465`` is a defacto standard for client email submissions before the
    creation of `RFC 2476 <https://tools.ietf.org/html/rfc2476>`_. It is safe
    to disable this unless you are forcing connections to this port. Read `more
    about ports here <https://blog.mailtrap.io/smtp-ports-25-465-587-used-for/>`_.
  * Fail2ban may be used to mitigate excessive user logins. Use custom filters
    generated by `extracting them from the mail docker image
    <https://github.com/tomav/docker-mailserver/tree/master/target/fail2ban>`_
    and adding as additional rules for fail2ban.

  ..  collapse:: README.md

    .. literalinclude:: ../README.md

Ports
*****
.. literalinclude:: ../defaults/main/ports.yml

Defaults
********
.. literalinclude:: ../defaults/main/main.yml

Users
*****
.. literalinclude:: ../defaults/main/users.yml
